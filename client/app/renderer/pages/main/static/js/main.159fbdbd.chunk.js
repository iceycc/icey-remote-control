(this.webpackJsonpmain=this.webpackJsonpmain||[]).push([[0],{14:function(e,n,t){},16:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t(2),c=t.n(a),i=t(7),o=t.n(i),s=(t(14),t(1)),u=t.n(s),d=t(3),p=t(5),f=t(8),h=window.require("electron"),l=h.desktopCapturer,w=h.ipcRenderer;function v(){return new Promise((function(e,n){l.getSources({types:["window","screen"]}).then(function(){var n=Object(d.a)(u.a.mark((function n(t){var r,a,c,i;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=Object(f.a)(t),n.prev=1,r.s();case 3:if((a=r.n()).done){n.next=17;break}return c=a.value,n.prev=5,n.next=8,navigator.mediaDevices.getUserMedia({audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:c.id,maxWidth:window.screen.width,maxHeight:window.screen.height}}});case 8:i=n.sent,e(i),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(5),console.error(n.t0);case 15:n.next=3;break;case 17:n.next=22;break;case 19:n.prev=19,n.t1=n.catch(1),r.e(n.t1);case 22:return n.prev=22,r.f(),n.finish(22);case 25:case"end":return n.stop()}}),n,null,[[1,19,22,25],[5,12]])})));return function(e){return n.apply(this,arguments)}}())}))}var b=new window.RTCPeerConnection({});function x(e){return j.apply(this,arguments)}function j(){return(j=Object(d.a)(u.a.mark((function e(n){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:return t=e.sent,b.addStream(t),e.next=6,b.setRemoteDescription(n);case 6:return e.t0=b,e.next=9,b.createAnswer();case 9:return e.t1=e.sent,e.next=12,e.t0.setLocalDescription.call(e.t0,e.t1);case 12:return console.log("answer",JSON.stringify(b.localDescription)),e.abrupt("return",b.localDescription);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}b.ondatachannel=function(e){e.channel.onmessage=function(e){var n=JSON.parse(e.data),t=n.type,r=n.data;"mouse"===t&&(r.screen={width:window.screen.width,height:window.screen.height}),w.send("robot",t,r)}},b.onicecandidate=function(e){console.log("candidate-control",JSON.stringify(e.candidate)),e.candidate&&w.send("forward","puppet-candidate",JSON.stringify(e.candidate))},w.on("candidate",(function(e,n){O(n)}));var g=[];function O(e){return m.apply(this,arguments)}function m(){return(m=Object(d.a)(u.a.mark((function e(n){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&g.push(n),!b.remoteDescription||!b.remoteDescription.type){e.next=11;break}t=0;case 3:if(!(t<g.length)){e.next=10;break}return r=JSON.parse(g[t]),e.next=7,b.addIceCandidate(new RTCIceCandidate(r));case 7:t++,e.next=3;break;case 10:g=[];case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}window.addIceCandidate=O,w.on("offer",function(){var e=Object(d.a)(u.a.mark((function e(n,t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(t);case 2:r=e.sent,w.send("forward","answer",{type:r.type,sdp:r.sdp});case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}());var k=window.require("electron").ipcRenderer;var y=function(){var e=Object(a.useState)(""),n=Object(p.a)(e,2),t=n[0],c=n[1],i=Object(a.useState)(""),o=Object(p.a)(i,2),s=o[0],f=o[1],h=Object(a.useState)(""),l=Object(p.a)(h,2),w=l[0],v=l[1],b=function(){var e=Object(d.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.invoke("login");case 2:if(n=e.sent,console.log(f(n)),n){e.next=6;break}return e.abrupt("return",f(n));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){return b(),k.on("control-state-change",x),function(){k.removeListener("control-state-change",x)}}),[]);var x=function(e,n,t){var r="";1===t?r="\u6b63\u5728\u8fdc\u7a0b\u63a7\u5236".concat(n):2===t&&(r="\u88ab".concat(n,"\u63a7\u5236")),v(r)};return Object(r.jsx)("div",{className:"App",children:""===w?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{children:["\u4f60\u7684\u63a7\u5236\u7801",s]}),Object(r.jsx)("input",{type:"text",value:t,onChange:function(e){return c(e.target.value)}}),Object(r.jsx)("button",{onClick:function(){return function(e){k.send("control",e)}(t)},children:"\u786e\u8ba4"})]}):Object(r.jsx)("div",{children:w})})},S=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,17)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,c=n.getLCP,i=n.getTTFB;t(e),r(e),a(e),c(e),i(e)}))};o.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(y,{})}),document.getElementById("root")),S()}},[[16,1,2]]]);